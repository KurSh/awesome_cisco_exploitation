/* $Id: authext.h,v 1.1.68.1 1996/04/19 14:57:47 che Exp $
 * $Source: /release/112/cvs/Xsys/crypto/sdu/include/auth/authext.h,v $
 *------------------------------------------------------------------
 * Cylink Source code: authext.h
 *
 * August 1995, Brian Weis
 *
 * Copyright (c) 1995-1996 by cisco Systems, Inc.
 * All rights reserved.
 *------------------------------------------------------------------
 * $Log: authext.h,v $
 * Revision 1.1.68.1  1996/04/19  14:57:47  che
 * CSCdi55138:  IosSec_branch feature commit
 * Branch: California_branch
 * IOS Security feature commits
 *
 * Revision 1.1.2.1  1995/11/28  01:49:52  bew
 * Branch: IosSec_branch
 * Port of newest Cylink SDU code, plus CS cleanup. The SDU code
 * is moved to its original Cylink tree structure.
 *
 * Revision 1.1  1995/11/22  23:21:56  bew
 * Placeholders for new SDU file locations.
 *
 * Revision 1.7  1995/06/07 12:03:05  smackie
 * Fold back Arizona_branch into mainline.
 *
 *------------------------------------------------------------------
 * $Endlog$
 */

/**************************************************************************
*  FileName: authext.h			Product Name: SecureLAN (SDU)
*  $Header: /SecureLAN/SDU/Include/Auth/AUTHEXT.H 11    7/13/95 5:25p Venkat 
*
*  Description:  Information shared by Auth Module with the System
*
*  Copyright (c) Cylink Corporation 1995. All rights reserved.
**************************************************************************
*
* $History: AUTHEXT.H 
* 
* *****************  Version 11  *****************
* User: Venkat       Date: 7/13/95    Time: 5:25p
* Updated in $/SecureLAN/SDU/Include/Auth
* <SMid, Seq#> are moved out of n/w cert to some SU<->SM authentication
* messages; Per SM info record has changed.
* 
* *****************  Version 10  *****************
* User: Venkat       Date: 7/12/95    Time: 10:36a
* Updated in $/SecureLAN/SDU/Include/Auth
* Rework on Authentication(esp, data structures, and Crypto Memory
* layout), unfix IV generation,...
* 
* *****************  Version 9  *****************
* User: Venkat       Date: 5/05/95    Time: 4:27p
* Updated in $/SecureLAN/SDU/Include/Auth
* Added a couple of Function prototypes.
* 
* *****************  Version 8  *****************
* User: Sduhost      Date: 4/28/95    Time: 4:56p
* Updated in $/SecureLAN/SDU/Include/Auth
* Error code to check SDU DSS Public # in the Network Certificate
* generated by SM.
* 
* *****************  Version 7  *****************
* User: Sduhost      Date: 3/19/95    Time: 11:56a
* Updated in $/SecureLAN/SDU/Include/Auth
* Eliminated external Cy Flash function prototypes - available through
* Crypto API.
* 
* *****************  Version 6  *****************
* User: Sduhost      Date: 3/04/95    Time: 1:31p
* Updated in $/SecureLAN/SDU/Include/Auth
* Update for Voice Id and Auth Ext. interface function prototyp.
* 
* *****************  Version 5  *****************
* User: Venkat       Date: 2/13/95    Time: 8:32a
* Updated in $/SecureLAN/SDU/Include/Auth
* IO error Processing glue - To be Tested.
* 
* *****************  Version 4  *****************
* User: Bald_eagle   Date: 2/01/95    Time: 1:22p
* Updated in $/SecureLAN/SDU/Include/Auth
* Eliminated Front Panel Prototypes.
* 
* *****************  Version 3  *****************
* User: Sduhost      Date: 1/27/95    Time: 3:12p
* Updated in $/SecureLAN/SDU/Include/Auth
* Made accessible Global Crypto Parameters(DSS, DH).
* 
* *****************  Version 2  *****************
* User: Sduhost      Date: 1/20/95    Time: 9:46a
* Updated in $/SecureLAN/SDU/Include/Auth
* Front Panel access functions Name changes.
* 
* *****************  Version 1  *****************
* User: Venkat       Date: 1/16/95    Time: 3:45p
* Created in $/SecureLAN/SDU/Include/auth
* Authentication 1st Release.
* 
**************************************************************************/

# ifndef AUTHEXT_H
# define AUTHEXT_H

/* communication with CS task which needs old or new key */
# define SM_DSS_PUBLIC_NEW				 1
# define SM_DSS_PUBLIC_OLD				 0

/* Per SM Network certificate seq # ; every time sequence # to be bumped up */
/* by this step (modulo 256) both at SDU and an SM */
# define PER_SM_NETCERT_SEQ_STEP		 8

/* Offset into DH shared # to generate Encrypt key */
# define DH2ENC_KEY_OFFSET				 0
# define SHA_LEN					  	20

/* Result of authentication functions - unique with Crypto Error Codes */
# define AUTH_SUCCESS           		  1
# define AUTH_NOT_READY				    -40 /* sdu has not generated DSS keys yet */
# define AUTH_NO_KNOWN_SM				-41 /* Invalid request:: (get, set, get) seq */
# define AUTH_SU_BUSY_LOCK				-42 /* SU already locked to an 'SM' */
# define AUTH_INVALID_REQ				-43 /* request is not acceptable(authState) */
# define AUTH_DSS_VRFY_FAIL				-44 /* dss sign fail */
# define AUTH_DATA_FAIL					-45 /* pdu (tlv error?) fields are not present */
# define AUTH_DATA_INVALID				-46 /* invalid value for a parameter */
# define AUTH_CHALLENGE_FAIL			-47   
# define AUTH_VOICE_FAIL				-48
# define AUTH_MSG_INVALID_LEN 			-49
# define AUTH_SM_TABLE_OVF				-50 /* authorized SMs table overflow */
# define AUTH_NETCERT_REV_ERR			-51 /* Net cert revision error */
# define AUTH_SMCERT_ERR         		-52 /* Net Cert Serial #  */
# define AUTH_CRYPTO_BREAK         		-53 /* No communication with Crypto Card */
# define CYFLASH_READ_ERROR				-54 /* CY Flash error */
# define AUTH_KEY_WAIT					-55 /* Waiting for User response - Voice Auth */

/* crypto api error return conditions identified by auth. module */
# define DSSGEN_AUTH_ERR				-56
# define HMEM_AUTH_ERR					-57

/* more error codes by auth module... */
# define AUTH_SDU_DSS_PUBLIC			-58 /* SM certificate does n't 've my DSS Public # */
# define AUTH_SM_CUSTID_ERR				-59 /* SM's customer id does not match SDU's */
# define AUTH_REV_SDUDSS_INVD           -60 /* Invalid OP: SDU New DSS # with no rev # increment */
# define AUTH_STIME_NONZERO             -61 /* During 1st nw cert load, (A, S) times must be 0s */

/* ------------------------ types ---------------------------------- */
typedef struct {  
			ulong  revision ;
			ushort aTime ;
			ushort sTime ;
			ulong  rTime ;
			ulong  eTime ;
		 } AuthNetControl ;

/* --------------------- Global En-/De-crypt Parameters --------------------- */
extern ushort dssPkeyLen ;		/* DSS parameters */
extern uchar dssP[] ;
extern uchar dssQ[] ;
extern uchar dssG[] ;

extern ushort dhPublicLen ;	/* DH parameters */
extern uchar dhModulus[] ;
extern uchar dhBase[] ;
		 
/* ------------Function Prototypes to interact with exeternal world---------- */

/* file "authinit.c" */
void authInitBootup( void) ;
void initSDUaddresses( void) ;
	   
/* file "authfun.c"  */
AuthNetControl	*getAuthTimers( void) ;
ulong getNCtimeStamp( void) ;
int getSDUdssSecretKeyIndex( uchar *sduDSSpublic) ;
uchar *getSMdssPublicKey( int which) ;
int getSMdhSecretKeyIndex( ulong ipAddress) ;
ushort  getSWversion ( void );

/* file "authmgr.c"  */
void authmgr(void);
 
/* file "authcy.c"  */
# endif
